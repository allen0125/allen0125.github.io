{"componentChunkName":"component---src-templates-blog-post-js","path":"/use-gbdt/","result":{"data":{"site":{"siteMetadata":{"title":"Allen's Blog"}},"markdownRemark":{"id":"015ceb27-f926-5444-b03e-6dcb65deaf5f","excerpt":"什么是GBDT？ DT－Decision Tree决策树，GB是Gradient Boosting，是一种学习策略，GBDT的含义就是用Gradient Boosting的策略训练出来的DT模型。模型的结果是一组回归分类树组合(CART Tree Ensemble)： T1…Tk。其中 Tj 学习的是之前 j-…","html":"<h2>什么是GBDT？</h2>\n<p>DT－Decision Tree决策树，GB是Gradient Boosting，是一种学习策略，GBDT的含义就是用Gradient Boosting的策略训练出来的DT模型。模型的结果是一组回归分类树组合(CART Tree Ensemble)： T1…Tk。其中 Tj 学习的是之前 j-1 棵树预测结果的残差，这种思想就像准备考试前的复习，先做一遍习题册，然后把做错的题目挑出来，在做一次，然后把做错的题目挑出来在做一次，经过反复多轮训练，取得最好的成绩。</p>\n<p>而模型最后的输出，是一个样本在各个树中输出的结果的和。</p>\n<h2>GBDT + LR ?</h2>\n<p>单独的使用GBDT模型，容易出现过拟合，在实际应用中往往使用 GBDT＋LR的方式做模型训练，算法更多细节可以参考 [Practical Lessons from Predicting Clicks on Ads at Facebook]。本文只介绍结论性的做法。</p>\n<p>首先根据样本训练出GBDT树，对于每个叶子节点，回溯到根节点都可以得到一组组合特征，所以用叶子节点的标号可以代表一个新的组合特征。</p>\n<p>这部分特征是GBDT生成的组合特征，再结合LR固有的稀疏特征，就组成了 GBDT ＋ LR 模型。生成样本向量阶段，样本首先过GBDT模型，生成组合特征部分的输入向量，再结合固有的稀疏特征向量，组成新的特征向量。</p>\n<p>最后将GBDT特征向量与LR稀疏向量组成一个最终的特征向量，并使用该向量训练LR模型。</p>\n<h2>实战</h2>\n<p>实战场景为模拟文本数据分类场景，选择AG News数据集。</p>\n<p>AG News 496,835 条来自 AG 新闻语料库 4 大类别超过 2000 个新闻源的新闻文章，数据集仅仅援用了标题和描述字段。 每个类别分别拥有 30,000 个训练样本及 1900 个测试样本。</p>\n<p><a href=\"https://arxiv.org/abs/1509.01626\">引文</a></p>\n<p><a href=\"https://s3.amazonaws.com/fast-ai-nlp/ag_news_csv.tgz\">下载地址</a></p>\n<h3>数据处理，文本转换向量</h3>\n<p>由于选用的数据为英文语料数据，所以不存在中文语料数据的切词问题，大大简化了数据处理过程与数据处理复杂程度。为了练习数据处理，这次数据处理使用三种方法：1、使用sklearn完成tf-idf的词袋模型，2、使 用gensim  的word2vec 工具完成数据转换为数据向量，3、使用keras-bert完成数据转换。</p>\n<p>完成数据处理后将得到三份特征数据，3份特征数据分别使用GBDT和GBDT+LR进行分类训练，得到6个分类模型，最后可以进行多维度对比。</p>\n<p>数据集本身就划分了训练集及测试集，所以在数据处理过程中无需在切分数据。完成数据转换向量之后即可开始搭建模型进行训练及验证。</p>\n<h3>单独训练 GBDT 查看过拟合现象:</h3>\n<p>TODO</p>\n<h3>结合 GBDT 和 LR 对比单独使用 GBDT 查看是否还存在过拟合现象：</h3>\n<p>TODO</p>\n<h3>多种模型多维度对比：</h3>\n<p>TODO</p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/30339807\">参考</a></p>","frontmatter":{"title":"理解GBDT及小试牛刀","date":"March 23, 2021","description":"通过记录理解GBDT的过程加深对GBDT的印象，然后在网上找到合适的数据集进行GBDT的实验以及GBDT+LR解决GBDT容易过拟合的实验。"}}},"pageContext":{"slug":"/use-gbdt/","previous":{"fields":{"slug":"/motorcycle-driving-licence/"},"frontmatter":{"title":"驾照增驾D摩托车驾驶资格过程回顾"}},"next":null}}}